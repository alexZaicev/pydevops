#!/bin/bash
#==============================================================================
# Name     : fmp.config
# Params   : n/a
#
#  *** always compare with the latest fmp.config.example for syntax changes ***
#==============================================================================
# Generic
#
TEST=YES                                 # Is this a test environment? (YES or NO)
TITLE_BAR='*** ALEX DEV VM ***'     # Text string to display at the top of the workbench main menu

VIM_COLORS=yes                           # Are the workbench vim resources required? (yes or no)

#==============================================================================
# System
#
FMP_HOST=${HOSTNAME}                     # name of the host machine
FMP_USER=${USER}                         # name of the user
FMP_HOME=${HOME}                         # location of the users home directory

FMP_LOG=${FMP_HOME}/log                  # location of the log directory

DOMAIN_NAME=FMP_HOME                     # name of the directory containing the module domain information

HELP_HOST=${FMP_HOST}                    # name of the GMP-Help host machine (HELP_PORT defined below)

OFFSET_PORTS=25100                       # offset to apply to the port number allocation

#==============================================================================
# Java
#
JAVA_HOME=/appl/java                     # location of the top-level java directory
ANT_HOME=/appl/ant                       # location of the top-level ant directory

JDK_TYPE=openJDK                         # type of JDK installed (either openJDK or oracleJava)

#==============================================================================
# Python
#
PYTHON_HOME=${FMP_HOME}/python           # location of the top level python directory for TM4C

#==============================================================================
# CBP Gateway
#
ENABLE_CBP_GATEWAY=false                 # use CBP Gateway for TM4C
CBP_GATEWAY_PORT=$(($OFFSET_PORTS + 66)) # network server port for CBP Gateway

#==============================================================================
# HTTPD CAS/KEYCLOAK
#
AUTHENTICATION_TYPE=KEYCLOAK                  # type of authentication used (CAS, KEYCLOAK or REMOTE_CAS)

HTTPD_HOST=${FMP_HOST}                   # name of the machine hosting HTTPD CAS ($FMP_HOST if local) - needed for certificate generation
HTTPD_OWNER=${FMP_USER}                  # name of the user hosting HTTPD CAS ($FMP_USER if local)

HTTPD_HOME=${FMP_HOME}/httpd             # location of httpd directory on the local machine
HTTPD_CA=${FMP_HOME}/CA                  # location of certificate directory

HTTPD_USER=daemon                        # name of the user and group for httpd.conf
HTTPD_GROUP=daemon

KEYCLOAK_HOST=${FMP_HOST}                # name of the machine hosting KEYCLOAK ($FMP_HOST if local)
KEYCLOAK_BASE_PORT=8443
KEYCLOAK_PORT_OFFSET=100
KEYCLOAK_KEY="652a96d3-6214-430c-ad56-41c974ab196f"

#==============================================================================
# Tomcat
#
TOMCAT_HOME=${FMP_HOME}/tomcat           # location of the top-level tomcat directory
TOMCAT_JAVA_TEMP=${TOMCAT_HOME}/temp     # location for temporary java files, jasper reports etc.

TOMCAT_STOP=90                           # time in seconds to allow tomcat to stop before timing out
TOMCAT_MEM=3G                            # amount of heap memory allocated for tomcat (JAVA_OPTS

#SECOM_IGT_HOST=172.22.0.18                    # secom igt hostname
#SECOM_IGT_PORT=28161                          # secom igt connection port
#SECOM_IGT_FILE=/igtPlus/servlet/itpservlet    # secom igt url file
#SECOM_IGT_FORMAT_SET=2018_11                  # secom igt message standard format set
#IGT_TEMPLATE_SET_URL=file:/igt/se9igt/lib/    # ??

AUTHORIZE_URL_LOGIN=no                   # enable URL Login (default is no) - yes requires manual configuration of ROOT.xml
SAML=no                                  # ignored if URL_LOGIN

#==============================================================================
# Tomcat and JBoss
#
DEBUG_LEVEL=HIGH                          # logging level within tomcat and jboss (HIGH, MEDIUM, LOW or OFF)
                                         # corresponds to logging DEBUG, INFO, WARN and ERROR respectively
ENABLE_REMOTE_SOCKET_DEBUG=true         # enable tomcat and jboss remote socket debugging

#HOSTNAME_OVERRIDE=                      # alternate hostname for use within secret.lib
#USERNAME_OVERRIDE=                      # alternate user name for use within secret.lib

#==============================================================================
# JBoss
#
JBOSS_HOST=${FMP_HOST}                   # name of the machine hosting JBOSS ($FMP_HOST if local)
JBOSS_HOME=${FMP_HOME}/jboss             # location of the top-level jboss directory
JBOSS_JAVA_TEMP=${FMP_HOME}/tmp          # location for temporary java files, jasper reports etc.

JBOSS_STARTUP=600                        # time in seconds to allow jboss to start before timing out
JBOSS_MEM=7G                            # amount of heap memory allocated for jboss (starting and expanding to)
                                         # default 16G, minimum 12G (JAVA_OPTS="-Xmx12G -Xms12G ...")
JBOSS_TRANSACTION_TIMEOUT=300            # time in seconds before a transaction timeout

MAIL_SERVER=mail.bbp.ch                  # name of the machine hosting the mail service
MAIL_USER=gmp1@mail.bbp.ch               # name of the pseudo user sending from the mail service

DERBY_PORT=1527                          # default network server port (only change if multiple GMP on the same server)
DISABLE_FP_CHECK=true                    # disable the checking of existing fingerprints
BYPASS_FP_CALC=false                     # bypass the generation of new fingerprints

#==============================================================================
# SQL database
#
DB_TYPE=INGRES                           # variety of database being used (ORACLE or INGRES or POSTGRES)

DB_CONNECT_URL="jdbc:ingres://${FMP_HOST}:I17/d01tm_db"          # connection string example for ingres
#DB_CONNECT_URL="jdbc:postgresql://${FMP_HOST}:5432/q01tm_db"  # connection string example for postgresql
#DB_CONNECT_URL="jdbc:oracle:thin:@${FMP_HOST}"                # connection string example for oracle

DB_USER=${FMP_USER}                      # database user (password will be read from vault)

#TNS_ADMIN=$FMP_HOME/install/5_db        # location of the tnsnames.ora file used by the oracle database

#==============================================================================
# Solr Indexer (this workbench only supports solr 6.5 or 6.6, maintained by the solr workbench)
#
SOLR_HOST=${FMP_HOST}                # ip address of the machine hosting the solr recent node
SOLR_LTA_HOST=${SOLR_HOST}               # ip address of the machine hosting the solr lta node
SOLR_USER=d01solr                         # name of the solr user for the recent node
SOLR_LTA_USER=${SOLR_USER}               # name of the solr user for the lta node (usually same as recent)

SOLR_SHORT=dev                           # "short" prefix applied to the collection and alias names

SOLR_SSL_ENABLED=false                   # the secure connection to solr is enabled (true or false)
SOLR_LTA_SSL_ENABLED=${SOLR_SSL_ENABLED} # when true the protocol is set to https, when false http

SOLR_AUTH_USERNAME=gmpsolr               # name and encrypted password used in the solr connection
SOLR_AUTH_PASSWORD=pe+sE1t25LN91B3KJffeVTNX90qCsk5OPlk

#==============================================================================
# COFI  (parameters for the ear config xml)
#
COFI_checkConditionsInAllEntities=true
COFI_enableStatsLog=false
COFI_extractWithExtractionType=true
COFI_listCacheTimeout=43200
COFI_maxFurtherInfoLength=1000
COFI_stpTimeout=170
COFI_useConcurrentListManager=false
COFI_useFakeFilter=false
COFI_useMetaServiceInCofi=true

COFI_maxResults=100

#==============================================================================
# Nucleus (IGTplus and Integrator) and RMA
#
NumNUC=1                                 # number of nucleus (designated as igtDS_<x> in standalone-full)
                                         # up to 20 permitted - repeat section below as necessary, setting the index

#--- NUC igtDS_1 ---
NUC_DB_TYPE[1]=INGRES                    # variety of database being used (ORACLE or INGRES)
NUC_CONNECT_URL[1]="jdbc:ingres://172.22.50.7:I17/ff2igt"    # connection string
NUC_DB_USER[1]=igtdb                     # database user (password will be read from vault)

#--- NUC igtDS_2 ---
#NUC_DB_TYPE[2]=INGRES
#NUC_CONNECT_URL[2]="jdbc:ingres://${FMP_HOST}:I17/igt2db"
#NUC_DB_USER[2]=igtdb2

#--- RMA ---
RMA_DB_TYPE=${NUC_DB_TYPE[1]}
RMA_CONNECT_URL=${NUC_CONNECT_URL[1]}
RMA_DB_USER=${NUC_DB_USER[1]}

#--- Integrator Link ---
#INT_HOST=xxx.xxx.xxx.xxx                # name of the machine hosting Integrator

#==============================================================================
# DXP connectors
#
GMP_KEYSTORE_PASSWORD=pfLyB1lq5e0jleb/tdc35U/KOkArExl1g17n    # encrypted password to access the keystore

#--- FIN
DXP_SERVICE[1]="FIN"                     # name of the DXP service/application
DXP_PORT[1]=$(($OFFSET_PORTS + 40))      # connection port for the DXP service/application
DXP_SSL_ENABLED[1]=false                 # the secure protocol is enabled for this connection (true or false)
DXP_KEYSTORE_PATH[1]="security/keystores/dxp/finear.keystore"      # keystore path (relative to $FMP_HOME/$DOMAIN_NAME)
DXP_KEYSTORE_PASSWORD[1]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="      # encrypted keystore password

#--- FUNDS, REPAIR
DXP_SERVICE[2]="FUNDS"
DXP_PORT[2]=$(($OFFSET_PORTS + 41))
DXP_SSL_ENABLED[2]=false
DXP_KEYSTORE_PATH[2]="security/keystores/dxp/fundsear.keystore"
DXP_KEYSTORE_PASSWORD[2]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- FILEFLOW
DXP_SERVICE[3]="FILEFLOW"
DXP_PORT[3]=$(($OFFSET_PORTS + 42))
DXP_SSL_ENABLED[3]=false
DXP_KEYSTORE_PATH[3]="security/keystores/dxp/fileflowear.keystore"
DXP_KEYSTORE_PASSWORD[3]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- COFI
#DXP_SERVICE[4]="COFI"
#DXP_PORT[4]=$(($OFFSET_PORTS + 43))
#DXP_SSL_ENABLED[4]=false
#DXP_KEYSTORE_PATH[4]="security/keystores/dxp/cofiear.keystore"
#DXP_KEYSTORE_PASSWORD[4]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- RIPPLE (reusing old MSGFLOW link)
#DXP_SERVICE[5]="RIPPLE"
#DXP_PORT[5]=$(($OFFSET_PORTS + 44))
#DXP_SSL_ENABLED[5]=false
#DXP_KEYSTORE_PATH[5]="security/keystores/dxp/rippleear.keystore"
#DXP_KEYSTORE_PASSWORD[5]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- SIC
#DXP_SERVICE[6]="SIC"
#DXP_PORT[6]=$(($OFFSET_PORTS + 45))
#DXP_SSL_ENABLED[6]=false
#DXP_KEYSTORE_PATH[6]="security/keystores/dxp/sicear.keystore"
#DXP_KEYSTORE_PASSWORD[6]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- EUROSIC
#DXP_SERVICE[7]="EUROSIC"
#DXP_PORT[7]=$(($OFFSET_PORTS + 46))
#DXP_SSL_ENABLED[7]=false
#DXP_KEYSTORE_PATH[7]="security/keystores/dxp/eurosicear.keystore"
#DXP_KEYSTORE_PASSWORD[7]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- *** NEW RMA on GMP database ***
#DXP_SERVICE[8]="RMA"
#DXP_PORT[8]=$(($OFFSET_PORTS + 47))
#DXP_SSL_ENABLED[8]=false
#DXP_KEYSTORE_PATH[8]="security/keystores/dxp/rmaear.keystore"
#DXP_KEYSTORE_PASSWORD[8]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- SWIFTMX
#DXP_SERVICE[9]="MX"
#DXP_PORT[9]=$(($OFFSET_PORTS + 48))
#DXP_SSL_ENABLED[9]=false
#DXP_KEYSTORE_PATH[9]="security/keystores/dxp/mxear.keystore"
#DXP_KEYSTORE_PASSWORD[9]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- CBP
#DXP_SERVICE[10]="CBP"
#DXP_PORT[10]=$(($OFFSET_PORTS + 49))
#DXP_SSL_ENABLED[10]=false
#DXP_KEYSTORE_PATH[10]="security/keystores/dxp/cbpear.keystore"
#DXP_KEYSTORE_PASSWORD[10]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#--- DIRECTORY
DXP_SERVICE[11]="DIRECTORY"
DXP_PORT[11]=$(($OFFSET_PORTS + 50))
DXP_SSL_ENABLED[11]=false
DXP_KEYSTORE_PATH[11]="security/keystores/dxp/directoryear.keystore"
DXP_KEYSTORE_PASSWORD[11]="4eNmf10u11aRUhjEY7S3t3CEEHI4sA=="

#==============================================================================
#            *** DO NOT EDIT beyond this line ***
#            *** these are strict conventions! ***
#------------------------------------------------------------------------------
HTTPD_PORT=$(($OFFSET_PORTS + 1))        # httpd access
KEYCLOAK_REDIRECT_PORT=$HTTPD_PORT
KEYCLOAK_AUTHS="https://${KEYCLOAK_HOST}:$(($KEYCLOAK_BASE_PORT+$KEYCLOAK_PORT_OFFSET))/auth"

#--- solr
SOLR_WEB_PORT=$(($OFFSET_PORTS + 3))     # solr recent node
SOLR_LTA_PORT=$(($OFFSET_PORTS + 39))    # solr lta node

#--- tomcat
TC_WebPort=$(($OFFSET_PORTS + 5))        # direct Tomcat access
HELP_PORT=${TC_WebPort}
TC_SSLPort=$(($OFFSET_PORTS + 6))
TC_StopPort=$(($OFFSET_PORTS + 7))
TC_AJPPort=$(($OFFSET_PORTS + 9))

#--- jboss
JB_RMIPort=$(($OFFSET_PORTS + 13))
JB_WEB_CONS=$(($OFFSET_PORTS + 90))      # jboss.management.port (http) JB_Console
JB_HTTPS=$(($OFFSET_PORTS + 81))
JB_IIOP=$(($OFFSET_PORTS + 84))
JB_IIOPS=$(($OFFSET_PORTS + 87))
#JB_JMX_CONS=$(($OFFSET_PORTS + 24))     # jmx-console for debugging

